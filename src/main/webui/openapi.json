{
  "openapi": "3.1.0",
  "components": {
    "schemas": {
      "FailedComponent": {
        "description": "Metadata of submitted components failed to be processed for scanning",
        "type": "object",
        "required": [
          "imageName",
          "imageVersion",
          "error"
        ],
        "properties": {
          "imageName": {
            "type": "string",
            "description": "Component name"
          },
          "imageVersion": {
            "type": "string",
            "description": "Component version"
          },
          "error": {
            "type": "string",
            "description": "Reason of failure"
          }
        }
      },
      "Feedback": {
        "description": "Data Transfer Object for submitting user feedback about a specific report.",
        "type": "object",
        "required": [
          "response",
          "rating",
          "reportId",
          "accuracy",
          "reasoning",
          "checklist"
        ],
        "properties": {
          "response": {
            "type": "string",
            "description": "The response feedback"
          },
          "rating": {
            "type": "integer",
            "format": "int32",
            "maximum": 5,
            "minimum": 1,
            "description": "Rating value from 1 to 5"
          },
          "comment": {
            "type": "string",
            "description": "Additional comment or feedback text"
          },
          "reportId": {
            "type": "string",
            "description": "Unique identifier of the report"
          },
          "accuracy": {
            "type": "string",
            "description": "Accuracy assessment of the report"
          },
          "reasoning": {
            "type": "string",
            "description": "Reasoning or explanation of the report"
          },
          "checklist": {
            "type": "string",
            "description": "Checklist assessment of the report"
          }
        }
      },
      "Image": {
        "description": "Image data (required if SBOM is not provided)",
        "type": "object",
        "required": [
          "analysis_type",
          "name",
          "tag",
          "source_info"
        ],
        "properties": {
          "analysis_type": {
            "type": "string",
            "description": "Analysis form type (image|source)"
          },
          "ecosystem": {
            "type": "string",
            "description": "Programming language ecosystem"
          },
          "manifest_path": {
            "type": "string",
            "description": "Manifest file path"
          },
          "name": {
            "type": "string",
            "description": "Image name"
          },
          "tag": {
            "type": "string",
            "description": "Image tag"
          },
          "source_info": {
            "description": "Source code information",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/SourceInfo"
            }
          },
          "sbom_info": {
            "description": "SBOM information",
            "type": "object"
          }
        }
      },
      "Justification": {
        "description": "Analysis justification for a vulnerability",
        "type": "object",
        "required": [
          "status",
          "label"
        ],
        "properties": {
          "status": {
            "type": "string",
            "description": "Justification status (true|false|unknown)"
          },
          "label": {
            "type": "string",
            "description": "Justification label"
          }
        }
      },
      "OverviewMetrics": {
        "description": "Metrics for the home page calculated from data in the last week",
        "type": "object",
        "properties": {
          "successfullyAnalyzed": {
            "type": "number",
            "format": "double",
            "description": "The count of reports that were completed in the last week (reports with completed_at not null and date within last 7 days)"
          },
          "averageReliabilityScore": {
            "type": "number",
            "format": "double",
            "description": "The average reliability score (intel_score) calculated as sum of all intel_score values divided by the count of completed reports from the last week"
          },
          "falsePositiveRate": {
            "type": "number",
            "format": "double",
            "description": "The percentage of false positives identified from completed reports in the last week, calculated as (reports with output.analysis.0.justification.status='FALSE' / total completed reports) * 100"
          }
        }
      },
      "Product": {
        "description": "Product metadata",
        "type": "object",
        "required": [
          "id",
          "name",
          "version",
          "submittedAt",
          "submittedCount",
          "metadata",
          "submissionFailures",
          "cveId"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Product ID"
          },
          "name": {
            "type": "string",
            "description": "Product name"
          },
          "version": {
            "type": "string",
            "description": "Product version"
          },
          "submittedAt": {
            "type": "string",
            "description": "Timestamp of product scan request submission"
          },
          "submittedCount": {
            "type": "integer",
            "format": "int32",
            "description": "Number of components submitted for scanning"
          },
          "metadata": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "description": "Product user provided metadata"
          },
          "submissionFailures": {
            "description": "List of submitted components failed to be processed for scanning",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/FailedComponent"
            }
          },
          "completedAt": {
            "type": "string",
            "description": "Timestamp of product scan request completion"
          },
          "cveId": {
            "type": "string",
            "description": "CVE ID associated with this product"
          }
        }
      },
      "ProductReportsSummary": {
        "description": "Product reports data",
        "type": "object",
        "required": [
          "productState",
          "statusCounts",
          "justificationStatusCounts"
        ],
        "properties": {
          "productState": {
            "type": "string",
            "description": "Product state of analysis"
          },
          "statusCounts": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "format": "int32"
            },
            "description": "Map of analysis state to count of reports with that state"
          },
          "justificationStatusCounts": {
            "type": "object",
            "additionalProperties": {
              "type": "integer",
              "format": "int32"
            },
            "description": "Map of justification status to count of reports with that status"
          }
        }
      },
      "ProductSummary": {
        "description": "Product metadata and reports data",
        "type": "object",
        "required": [
          "data",
          "summary"
        ],
        "properties": {
          "data": {
            "description": "Product data",
            "type": "object",
            "required": [
              "id",
              "name",
              "version",
              "submittedAt",
              "submittedCount",
              "metadata",
              "submissionFailures",
              "cveId"
            ],
            "properties": {
              "id": {
                "type": "string",
                "description": "Product ID"
              },
              "name": {
                "type": "string",
                "description": "Product name"
              },
              "version": {
                "type": "string",
                "description": "Product version"
              },
              "submittedAt": {
                "type": "string",
                "description": "Timestamp of product scan request submission"
              },
              "submittedCount": {
                "type": "integer",
                "format": "int32",
                "description": "Number of components submitted for scanning"
              },
              "metadata": {
                "type": "object",
                "additionalProperties": {
                  "type": "string"
                },
                "description": "Product user provided metadata"
              },
              "submissionFailures": {
                "description": "List of submitted components failed to be processed for scanning",
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/FailedComponent"
                }
              },
              "completedAt": {
                "type": "string",
                "description": "Timestamp of product scan request completion"
              },
              "cveId": {
                "type": "string",
                "description": "CVE ID associated with this product"
              }
            }
          },
          "summary": {
            "description": "Product reports summary data",
            "type": "object",
            "required": [
              "productState",
              "statusCounts",
              "justificationStatusCounts"
            ],
            "properties": {
              "productState": {
                "type": "string",
                "description": "Product state of analysis"
              },
              "statusCounts": {
                "type": "object",
                "additionalProperties": {
                  "type": "integer",
                  "format": "int32"
                },
                "description": "Map of analysis state to count of reports with that state"
              },
              "justificationStatusCounts": {
                "type": "object",
                "additionalProperties": {
                  "type": "integer",
                  "format": "int32"
                },
                "description": "Map of justification status to count of reports with that status"
              }
            }
          }
        }
      },
      "Report": {
        "description": "Report metadata",
        "type": "object",
        "required": [
          "id",
          "name",
          "startedAt",
          "completedAt",
          "imageName",
          "imageTag",
          "state",
          "vulns",
          "metadata"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "Report ID"
          },
          "name": {
            "type": "string",
            "description": "Report name"
          },
          "startedAt": {
            "type": "string",
            "description": "Started at timestamp for report analysis"
          },
          "completedAt": {
            "type": "string",
            "description": "Completed at timestamp for report analysis"
          },
          "imageName": {
            "type": "string",
            "description": "Image name"
          },
          "imageTag": {
            "type": "string",
            "description": "Image tag"
          },
          "state": {
            "type": "string",
            "description": "State of the report analysis"
          },
          "vulns": {
            "description": "Vulnerabilities in the report and their analysis results",
            "type": "array",
            "items": {
              "$ref": "#/components/schemas/VulnResult"
            }
          },
          "metadata": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "description": "User provided metadata for the report"
          },
          "gitRepo": {
            "type": "string",
            "description": "Git repository URL from source_info"
          },
          "ref": {
            "type": "string",
            "description": "Git reference (commit hash, tag, or branch) from source_info"
          }
        }
      },
      "ReportData": {
        "description": "A single report request",
        "type": "object",
        "required": [
          "reportRequestId",
          "report"
        ],
        "properties": {
          "reportRequestId": {
            "description": "Report identification",
            "type": "object",
            "required": [
              "id",
              "reportId"
            ],
            "properties": {
              "id": {
                "type": "string",
                "description": "ID assigned for database identification"
              },
              "reportId": {
                "type": "string",
                "description": "ID assigned on scan request submission"
              }
            }
          },
          "report": {
            "description": "Report payload",
            "type": "object"
          }
        }
      },
      "ReportRequest": {
        "description": "A single report request",
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "description": "ID assigned on scan request submission (auto-generated if not provided)"
          },
          "analysisType": {
            "type": "string",
            "description": "Analysis form type (image|source)"
          },
          "vulnerabilities": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "List of vulnerability IDs to analyze"
          },
          "image": {
            "description": "Image data (required if SBOM is not provided)",
            "type": "object",
            "required": [
              "analysis_type",
              "name",
              "tag",
              "source_info"
            ],
            "properties": {
              "analysis_type": {
                "type": "string",
                "description": "Analysis form type (image|source)"
              },
              "ecosystem": {
                "type": "string",
                "description": "Programming language ecosystem"
              },
              "manifest_path": {
                "type": "string",
                "description": "Manifest file path"
              },
              "name": {
                "type": "string",
                "description": "Image name"
              },
              "tag": {
                "type": "string",
                "description": "Image tag"
              },
              "source_info": {
                "description": "Source code information",
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/SourceInfo"
                }
              },
              "sbom_info": {
                "description": "SBOM information",
                "type": "object"
              }
            }
          },
          "sbom": {
            "description": "SBOM data (required if image is not provided)",
            "type": "object",
            "examples": [
              {
                "$schema": "http://cyclonedx.org/schema/bom-1.6.schema.json",
                "bomFormat": "CycloneDX",
                "specVersion": "1.6",
                "serialNumber": "generated UUID",
                "version": 1,
                "metadata": {
                  "timestamp": "current timestamp",
                  "tools": [],
                  "component": {},
                  "properties": []
                },
                "components": [],
                "dependencies": []
              }
            ]
          },
          "sbom_info_type": {
            "type": "string",
            "description": "SBOM information type",
            "enum": [
              "manual",
              "cyclonedx+json"
            ]
          },
          "metadata": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "description": "Request metadata"
          },
          "sourceRepo": {
            "type": "string",
            "description": "Source code repository (required if SBOM is not provided)"
          },
          "commitId": {
            "type": "string",
            "description": "Commit ID (required if SBOM is not provided)"
          },
          "ecosystem": {
            "type": "string",
            "description": "Programming language ecosystem"
          },
          "manifestPath": {
            "type": "string",
            "description": "Manifest file path"
          }
        },
        "required": [
          "analysisType",
          "vulnerabilities",
          "metadata"
        ]
      },
      "ReportRequestId": {
        "description": "Report identification",
        "type": "object",
        "required": [
          "id",
          "reportId"
        ],
        "properties": {
          "id": {
            "type": "string",
            "description": "ID assigned for database identification"
          },
          "reportId": {
            "type": "string",
            "description": "ID assigned on scan request submission"
          }
        }
      },
      "ReportWithStatus": {
        "description": "Report data with calculated analysis status",
        "type": "object",
        "required": [
          "report",
          "status"
        ],
        "properties": {
          "report": {
            "description": "Full report data from MongoDB",
            "type": "object"
          },
          "status": {
            "type": "string",
            "description": "Calculated analysis status of the report (completed, queued, sent, expired, failed, pending, unknown)"
          }
        }
      },
      "SbomInfoType": {
        "description": "SBOM information type",
        "type": "string",
        "enum": [
          "MANUAL",
          "CYCLONEDX_JSON"
        ]
      },
      "SourceInfo": {
        "description": "Source code information",
        "type": "object",
        "required": [
          "type",
          "git_repo",
          "ref",
          "include",
          "exclude"
        ],
        "properties": {
          "type": {
            "type": "string",
            "description": "Type of source code (code|doc)"
          },
          "git_repo": {
            "type": "string",
            "description": "Git repository URL"
          },
          "ref": {
            "type": "string",
            "description": "Git reference (commit hash, tag, or branch)"
          },
          "include": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Patterns to include in the analysis"
          },
          "exclude": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Patterns to exclude from the analysis"
          }
        }
      },
      "UserComments": {
        "description": "User provided comments on a vulnerability",
        "type": "object",
        "required": [
          "cve_id"
        ],
        "properties": {
          "cve_id": {
            "type": "string",
            "description": "CVE ID"
          },
          "nvd_cve_description": {
            "type": "string",
            "description": "CVE Description"
          },
          "nvd_cvss_vector": {
            "type": "string",
            "description": "CVSS Vector string"
          },
          "nvd_cwe_name": {
            "type": "string",
            "description": "CWE Name"
          },
          "ghsa_vulnerabilities": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": {}
            },
            "description": "GHSA Details"
          },
          "nvd_configurations": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": {}
            },
            "description": "Known Affected Software"
          },
          "nvd_cwe_description": {
            "type": "string",
            "description": "CWE Description"
          },
          "nvd_cwe_extended_description": {
            "type": "string",
            "description": "CWE Extended Description"
          },
          "nvd_vendor_names": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "Notable Vulnerable Software Vendors"
          },
          "rhsa_bugzilla_description": {
            "type": "string",
            "description": "RHSA Description"
          },
          "rhsa_details": {
            "type": "array",
            "items": {
              "type": "string"
            },
            "description": "RHSA Details"
          },
          "rhsa_package_state": {
            "type": "array",
            "items": {
              "type": "object",
              "additionalProperties": {
                "type": "string"
              }
            },
            "description": "RHSA Affected Packages"
          },
          "rhsa_statement": {
            "type": "string",
            "description": "RHSA Statement"
          },
          "ubuntu_ubuntu_description": {
            "type": "string",
            "description": "Ubuntu Description"
          },
          "vulnerable_dependencies": {
            "type": "string",
            "description": "Identified Vulnerable Dependencies"
          }
        }
      },
      "ValidationErrorResponse": {
        "description": "Validation error response mapping field names to error messages",
        "type": "object",
        "properties": {
          "errors": {
            "type": "object",
            "additionalProperties": {
              "type": "string"
            },
            "description": "Map of field names to error messages"
          }
        }
      },
      "VulnResult": {
        "description": "Vulnerability analysis information",
        "type": "object",
        "required": [
          "vulnId",
          "justification"
        ],
        "properties": {
          "vulnId": {
            "type": "string",
            "description": "Vulnerability ID (CVE ID)"
          },
          "justification": {
            "description": "Analysis justification for the vulnerability",
            "type": "object",
            "required": [
              "status",
              "label"
            ],
            "properties": {
              "status": {
                "type": "string",
                "description": "Justification status (true|false|unknown)"
              },
              "label": {
                "type": "string",
                "description": "Justification label"
              }
            }
          }
        }
      }
    },
    "securitySchemes": {
      "jwt": {
        "type": "http",
        "description": "Please enter your JWT Token without Bearer",
        "scheme": "bearer",
        "bearerFormat": "jwt"
      },
      "SecurityScheme": {
        "type": "openIdConnect",
        "description": "Authentication"
      }
    }
  },
  "paths": {
    "/api/v1/feedback": {
      "post": {
        "summary": "Submit user feedback for an AI response",
        "description": "Submits user feedback for an AI response to the feedback service",
        "requestBody": {
          "description": "User feedback data",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/Feedback"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Feedback successfully processed",
            "content": {
              "application/json": {
                "examples": {
                  "Success Response": {
                    "value": {
                      "status": "success"
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Bad Request"
          }
        },
        "tags": [
          "Feedback Resource"
        ]
      }
    },
    "/api/v1/feedback/{reportId}/exists": {
      "get": {
        "summary": "Check if feedback exists for a report",
        "description": "Checks if feedback has been submitted for a specific report",
        "parameters": [
          {
            "description": "Report identifier",
            "required": true,
            "name": "reportId",
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Feedback existence status retrieved successfully",
            "content": {
              "application/json": {
                "examples": {
                  "Feedback exists": {
                    "value": {
                      "exists": true
                    }
                  },
                  "Feedback does not exist": {
                    "value": {
                      "exists": false
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "tags": [
          "Feedback Resource"
        ]
      }
    },
    "/api/v1/generate-sbom": {
      "post": {
        "summary": "Generate SBOM",
        "description": "Generates a Software Bill of Materials (SBOM) for a container image",
        "requestBody": {
          "description": "Container image name and tag",
          "content": {
            "text/plain": {
              "examples": {
                "nginx:latest": {
                  "value": "nginx:latest"
                }
              },
              "schema": {
                "type": "string"
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "SBOM generated successfully",
            "content": {
              "application/json": {
                "examples": {
                  "CycloneDX SBOM": {
                    "value": {
                      "$schema": "http://cyclonedx.org/schema/bom-1.6.schema.json",
                      "bomFormat": "CycloneDX",
                      "specVersion": "1.6",
                      "serialNumber": "generated UUID",
                      "version": 1,
                      "metadata": {
                        "timestamp": "current timestamp",
                        "tools": [],
                        "component": {},
                        "properties": []
                      },
                      "components": [],
                      "dependencies": []
                    }
                  }
                },
                "schema": {
                  "type": "object"
                }
              }
            }
          },
          "400": {
            "description": "Image has not been provided"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Generate Sbom Endpoint"
        ]
      }
    },
    "/api/v1/overview-metrics": {
      "get": {
        "summary": "Get overview metrics",
        "description": "Retrieves metrics for the home page calculated from data in the last week, including count of successfully analyzed reports, average reliability score, and false positive rate",
        "tags": [
          "Overview Metrics"
        ],
        "responses": {
          "200": {
            "description": "Overview metrics retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/OverviewMetrics"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        }
      }
    },
    "/api/v1/pre-processing": {
      "post": {
        "summary": "Submit report requests for pre-processing",
        "description": "Submits a list of report requests for pre-processing to the Component Syncer",
        "requestBody": {
          "description": "List of report requests for pre-processing",
          "content": {
            "application/json": {
              "schema": {
                "type": "array",
                "items": {
                  "$ref": "#/components/schemas/ReportData"
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "200": {
            "description": "Pre-processing request accepted by the Component Syncer",
            "content": {
              "application/json": {
                "schema": {}
              }
            }
          },
          "500": {
            "description": "Internal server error"
          },
          "400": {
            "description": "Bad Request"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Pre Processing Endpoint"
        ]
      }
    },
    "/api/v1/products": {
      "get": {
        "summary": "List all product data",
        "description": "Retrieves paginated, sortable, and filterable product data for all products",
        "parameters": [
          {
            "name": "cveId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": "0"
            }
          },
          {
            "name": "pageSize",
            "in": "query",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": "100"
            }
          },
          {
            "name": "sortDirection",
            "in": "query",
            "schema": {
              "type": "string",
              "default": "DESC"
            }
          },
          {
            "name": "sortField",
            "in": "query",
            "schema": {
              "type": "string",
              "default": "submittedAt"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Product data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ProductSummary"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Product Endpoint"
        ]
      }
    },
    "/api/v1/products/upload-cyclonedx": {
      "post": {
        "summary": "Upload CycloneDX file for analysis",
        "description": "Accepts a CVE ID and CycloneDX JSON file, validates them, and queues the report for analysis",
        "requestBody": {
          "content": {
            "multipart/form-data": {
              "schema": {
                "type": "object",
                "properties": {
                  "cveId": {
                    "type": "string"
                  },
                  "file": {
                    "type": "string",
                    "format": "binary"
                  }
                }
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "File uploaded and queued for analysis",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportData"
                }
              }
            }
          },
          "400": {
            "description": "Validation error with field-specific error messages"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Product Endpoint"
        ]
      }
    },
    "/api/v1/products/{id}": {
      "delete": {
        "parameters": [
          {
            "description": "Product ID",
            "required": true,
            "name": "id",
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Product deletion request accepted"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "summary": "Remove",
        "tags": [
          "Product Endpoint"
        ]
      },
      "get": {
        "summary": "Get product",
        "description": "Gets product by ID from database",
        "parameters": [
          {
            "description": "Product ID",
            "required": true,
            "name": "id",
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Product found in database",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ProductSummary"
                }
              }
            }
          },
          "404": {
            "description": "Product not found in database"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Product Endpoint"
        ]
      }
    },
    "/api/v1/reports": {
      "delete": {
        "summary": "Delete multiple analysis reports",
        "description": "Deletes multiple analysis reports by IDs or using filter parameters",
        "parameters": [
          {
            "description": "List of report IDs to delete (24-character hexadecimal MongoDB ObjectId format)",
            "name": "reportIds",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Reports deletion request accepted"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      },
      "post": {
        "summary": "Receive analysis report",
        "description": "Receives a completed analysis report from Morpheus",
        "requestBody": {
          "content": {
            "application/json": {
              "schema": {
                "type": "string"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Report received",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportRequestId"
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      },
      "get": {
        "summary": "List analysis reports",
        "description": "Retrieves a paginated list of analysis reports with optional filtering and sorting",
        "parameters": [
          {
            "description": "Filter by ExploitIQ status. Valid values: TRUE, FALSE, UNKNOWN",
            "name": "exploitIqStatus",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Filter by image name",
            "name": "imageName",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Filter by image tag",
            "name": "imageTag",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Page number (0-based)",
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": "0"
            }
          },
          {
            "description": "Number of items per page",
            "name": "pageSize",
            "in": "query",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": "100"
            }
          },
          {
            "description": "Filter by SBOM report ID (metadata.product_id)",
            "name": "productId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Filter by report ID (input.scan.id)",
            "name": "reportId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Sort criteria in format 'field:direction'",
            "name": "sortBy",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "default": "submittedAt:DESC"
            }
          },
          {
            "description": "Filter by status. Valid values: completed, sent, failed, queued, expired, pending",
            "name": "status",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Filter by vulnerability ID (CVE ID)",
            "name": "vulnId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Reports retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/Report"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      }
    },
    "/api/v1/reports/new": {
      "post": {
        "summary": "Create new analysis request",
        "description": "Creates a new analysis report request, processes it and optionally submits it to ExploitIQ for analysis",
        "parameters": [
          {
            "description": "Whether to submit to ExploitIQ for analysis",
            "name": "submit",
            "in": "query",
            "schema": {
              "type": "boolean",
              "default": true
            }
          }
        ],
        "requestBody": {
          "description": "Analysis report request data",
          "content": {
            "application/json": {
              "schema": {
                "$ref": "#/components/schemas/ReportRequest"
              }
            }
          },
          "required": true
        },
        "responses": {
          "202": {
            "description": "Analysis request accepted",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportData"
                }
              }
            }
          },
          "400": {
            "description": "Invalid request data"
          },
          "429": {
            "description": "Request queue exceeded"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      }
    },
    "/api/v1/reports/product": {
      "delete": {
        "summary": "Delete product by IDs",
        "description": "Deletes all component analysis reports and product metadata associated with specified product IDs",
        "parameters": [
          {
            "description": "List of product IDs to delete",
            "required": true,
            "name": "productIds",
            "in": "query",
            "schema": {
              "type": "array",
              "items": {
                "type": "string"
              }
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Product deletion request accepted"
          },
          "400": {
            "description": "Invalid request - no product IDs provided"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      },
      "get": {
        "summary": "List all product data",
        "description": "Retrieves paginated, sortable, and filterable product data for all products",
        "parameters": [
          {
            "name": "cveId",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "name",
            "in": "query",
            "schema": {
              "type": "string"
            }
          },
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": "0"
            }
          },
          {
            "name": "pageSize",
            "in": "query",
            "schema": {
              "type": "integer",
              "format": "int32",
              "default": "100"
            }
          },
          {
            "name": "sortDirection",
            "in": "query",
            "schema": {
              "type": "string",
              "default": "DESC"
            }
          },
          {
            "name": "sortField",
            "in": "query",
            "schema": {
              "type": "string",
              "default": "submittedAt"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Product data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "array",
                  "items": {
                    "$ref": "#/components/schemas/ProductSummary"
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      }
    },
    "/api/v1/reports/product/{id}": {
      "delete": {
        "summary": "Delete product by ID",
        "description": "Deletes all component analysis reports and product metadata associated with a specific product ID",
        "parameters": [
          {
            "description": "Product ID to delete",
            "required": true,
            "name": "id",
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Product deletion request accepted"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      },
      "get": {
        "summary": "Get product data by ID",
        "description": "Retrieves product data for a specific product ID",
        "parameters": [
          {
            "description": "Product ID",
            "required": true,
            "name": "id",
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Product data retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "description": "Product metadata and reports data",
                  "type": "object",
                  "required": [
                    "data",
                    "summary"
                  ],
                  "properties": {
                    "data": {
                      "description": "Product data",
                      "type": "object",
                      "required": [
                        "id",
                        "name",
                        "version",
                        "submittedAt",
                        "submittedCount",
                        "metadata",
                        "submissionFailures",
                        "cveId"
                      ],
                      "properties": {
                        "id": {
                          "type": "string",
                          "description": "Product ID"
                        },
                        "name": {
                          "type": "string",
                          "description": "Product name"
                        },
                        "version": {
                          "type": "string",
                          "description": "Product version"
                        },
                        "submittedAt": {
                          "type": "string",
                          "description": "Timestamp of product scan request submission"
                        },
                        "submittedCount": {
                          "type": "integer",
                          "format": "int32",
                          "description": "Number of components submitted for scanning"
                        },
                        "metadata": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "string"
                          },
                          "description": "Product user provided metadata"
                        },
                        "submissionFailures": {
                          "description": "List of submitted components failed to be processed for scanning",
                          "type": "array",
                          "items": {
                            "$ref": "#/components/schemas/FailedComponent"
                          }
                        },
                        "completedAt": {
                          "type": "string",
                          "description": "Timestamp of product scan request completion"
                        },
                        "cveId": {
                          "type": "string",
                          "description": "CVE ID associated with this product"
                        }
                      }
                    },
                    "summary": {
                      "description": "Product reports summary data",
                      "type": "object",
                      "required": [
                        "productState",
                        "statusCounts",
                        "justificationStatusCounts"
                      ],
                      "properties": {
                        "productState": {
                          "type": "string",
                          "description": "Product state of analysis"
                        },
                        "statusCounts": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "integer",
                            "format": "int32"
                          },
                          "description": "Map of analysis state to count of reports with that state"
                        },
                        "justificationStatusCounts": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "integer",
                            "format": "int32"
                          },
                          "description": "Map of justification status to count of reports with that status"
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      }
    },
    "/api/v1/reports/{id}": {
      "delete": {
        "summary": "Delete analysis report",
        "description": "Deletes a specific analysis report by ID",
        "parameters": [
          {
            "description": "Report ID to delete (24-character hexadecimal MongoDB ObjectId format)",
            "required": true,
            "name": "id",
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Report deletion request accepted"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      },
      "get": {
        "summary": "Get analysis report",
        "description": "Retrieves a specific analysis report by ID with calculated analysis status",
        "parameters": [
          {
            "description": "Report ID to get (24-character hexadecimal MongoDB ObjectId format)",
            "required": true,
            "name": "id",
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Report retrieved successfully",
            "content": {
              "application/json": {
                "schema": {
                  "$ref": "#/components/schemas/ReportWithStatus"
                }
              }
            }
          },
          "404": {
            "description": "Report not found"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      }
    },
    "/api/v1/reports/{id}/failed": {
      "post": {
        "summary": "Mark analysis request as failed",
        "description": "Marks an analysis request as failed with error details",
        "parameters": [
          {
            "description": "Report ID to mark as failed (24-character hexadecimal MongoDB ObjectId format)",
            "required": true,
            "name": "id",
            "in": "path",
            "schema": {
              "type": "string"
            }
          },
          {
            "description": "Error message describing the failure",
            "required": true,
            "name": "errorMessage",
            "in": "query",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Failure status record accepted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "examples": [
                    "66155fd9639dbb7e7e4e44b8"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      }
    },
    "/api/v1/reports/{id}/retry": {
      "post": {
        "summary": "Retry analysis request",
        "description": "Retries an existing analysis request by ID",
        "parameters": [
          {
            "description": "Report ID to retry (24-character hexadecimal MongoDB ObjectId format)",
            "required": true,
            "name": "id",
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Retry request accepted",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "examples": [
                    "66155fd9639dbb7e7e4e44b8"
                  ]
                }
              }
            }
          },
          "404": {
            "description": "Request not found",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "examples": [
                    "66155fd9639dbb7e7e4e44b8"
                  ]
                }
              }
            }
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      }
    },
    "/api/v1/reports/{id}/submit": {
      "post": {
        "summary": "Submit to ExploitIQ for analysis",
        "description": "Submits analysis request to ExploitIQ for analysis",
        "parameters": [
          {
            "description": "Request payload (report) ID to submit (24-character hexadecimal MongoDB ObjectId format)",
            "required": true,
            "name": "id",
            "in": "path",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "202": {
            "description": "Request submitted successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "string",
                  "examples": [
                    "66155fd9639dbb7e7e4e44b8"
                  ]
                }
              }
            }
          },
          "400": {
            "description": "Invalid request data"
          },
          "404": {
            "description": "Request payload not found"
          },
          "429": {
            "description": "Request queue exceeded"
          },
          "500": {
            "description": "Internal server error"
          }
        },
        "security": [
          {
            "jwt": []
          }
        ],
        "tags": [
          "Report Endpoint"
        ]
      }
    }
  },
  "tags": [
    {
      "name": "Overview Metrics"
    }
  ],
  "info": {
    "title": "exploit-iq-client API",
    "version": "1.0.0-SNAPSHOT"
  }
}
